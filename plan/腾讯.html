<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一面 | blueprint的博客</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <meta name="description" content="专注于前端技术栈">
    
    <link rel="preload" href="/blog/assets/css/0.styles.a903d165.css" as="style"><link rel="preload" href="/blog/assets/js/app.44f11c97.js" as="script"><link rel="preload" href="/blog/assets/js/2.bea9b8b0.js" as="script"><link rel="preload" href="/blog/assets/js/44.02ad5c3b.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.9c19439e.js"><link rel="prefetch" href="/blog/assets/js/11.50e7e57b.js"><link rel="prefetch" href="/blog/assets/js/12.00d20f29.js"><link rel="prefetch" href="/blog/assets/js/13.2c46ed50.js"><link rel="prefetch" href="/blog/assets/js/14.b105fa13.js"><link rel="prefetch" href="/blog/assets/js/15.708a71e6.js"><link rel="prefetch" href="/blog/assets/js/16.b3b0d831.js"><link rel="prefetch" href="/blog/assets/js/17.e1b75c8c.js"><link rel="prefetch" href="/blog/assets/js/18.fe00f300.js"><link rel="prefetch" href="/blog/assets/js/19.d55e64bc.js"><link rel="prefetch" href="/blog/assets/js/20.21139e64.js"><link rel="prefetch" href="/blog/assets/js/21.8d581f0b.js"><link rel="prefetch" href="/blog/assets/js/22.c23fb302.js"><link rel="prefetch" href="/blog/assets/js/23.08ef3395.js"><link rel="prefetch" href="/blog/assets/js/24.6893fb74.js"><link rel="prefetch" href="/blog/assets/js/25.553e86dd.js"><link rel="prefetch" href="/blog/assets/js/26.3525d7a5.js"><link rel="prefetch" href="/blog/assets/js/27.d0600e38.js"><link rel="prefetch" href="/blog/assets/js/28.cbaf1559.js"><link rel="prefetch" href="/blog/assets/js/29.3d9743ec.js"><link rel="prefetch" href="/blog/assets/js/3.691d9991.js"><link rel="prefetch" href="/blog/assets/js/30.875260e3.js"><link rel="prefetch" href="/blog/assets/js/31.171e3383.js"><link rel="prefetch" href="/blog/assets/js/32.5b4b522b.js"><link rel="prefetch" href="/blog/assets/js/33.f9c2ba74.js"><link rel="prefetch" href="/blog/assets/js/34.15cf2b1d.js"><link rel="prefetch" href="/blog/assets/js/35.007e117d.js"><link rel="prefetch" href="/blog/assets/js/36.45d89f26.js"><link rel="prefetch" href="/blog/assets/js/37.51312960.js"><link rel="prefetch" href="/blog/assets/js/38.13771274.js"><link rel="prefetch" href="/blog/assets/js/39.a412b670.js"><link rel="prefetch" href="/blog/assets/js/4.0515568e.js"><link rel="prefetch" href="/blog/assets/js/40.05a0b8cb.js"><link rel="prefetch" href="/blog/assets/js/41.45453a21.js"><link rel="prefetch" href="/blog/assets/js/42.4980fb2e.js"><link rel="prefetch" href="/blog/assets/js/43.aed0c501.js"><link rel="prefetch" href="/blog/assets/js/45.e6d5c7f6.js"><link rel="prefetch" href="/blog/assets/js/46.fad203fa.js"><link rel="prefetch" href="/blog/assets/js/47.fb08130a.js"><link rel="prefetch" href="/blog/assets/js/48.b9c8cd5d.js"><link rel="prefetch" href="/blog/assets/js/49.6fb00b14.js"><link rel="prefetch" href="/blog/assets/js/5.616f4b04.js"><link rel="prefetch" href="/blog/assets/js/50.efe4c65c.js"><link rel="prefetch" href="/blog/assets/js/51.0c5513ee.js"><link rel="prefetch" href="/blog/assets/js/52.bbf39996.js"><link rel="prefetch" href="/blog/assets/js/53.4bbd31b3.js"><link rel="prefetch" href="/blog/assets/js/54.4ccd4e5e.js"><link rel="prefetch" href="/blog/assets/js/55.3c54e068.js"><link rel="prefetch" href="/blog/assets/js/56.e3e17f3b.js"><link rel="prefetch" href="/blog/assets/js/57.74993949.js"><link rel="prefetch" href="/blog/assets/js/58.f15129ca.js"><link rel="prefetch" href="/blog/assets/js/6.8c37003d.js"><link rel="prefetch" href="/blog/assets/js/7.c645d8de.js"><link rel="prefetch" href="/blog/assets/js/8.665069b1.js"><link rel="prefetch" href="/blog/assets/js/9.63c32f9c.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.a903d165.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">blueprint的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/" class="nav-link">
  js笔记
</a></li><li class="dropdown-item"><!----> <a href="/blog/html/" class="nav-link">
  html和浏览器
</a></li><li class="dropdown-item"><!----> <a href="/blog/css/" class="nav-link">
  css笔记
</a></li><li class="dropdown-item"><!----> <a href="/blog/regexp/" class="nav-link">
  正则
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js框架和库" class="dropdown-title"><span class="title">js框架和库</span> <span class="arrow down"></span></button> <button type="button" aria-label="js框架和库" class="mobile-dropdown-title"><span class="title">js框架和库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue/" class="nav-link">
  vue专题
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/" class="nav-link">
  react专题
</a></li><li class="dropdown-item"><!----> <a href="/blog/redux/" class="nav-link">
  redux
</a></li><li class="dropdown-item"><!----> <a href="/blog/axios/" class="nav-link">
  axios
</a></li></ul></div></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/interview/" class="nav-link">
  面试题
</a></div> <a href="https://github.com/blueprint1453/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端" class="mobile-dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javascript/" class="nav-link">
  js笔记
</a></li><li class="dropdown-item"><!----> <a href="/blog/html/" class="nav-link">
  html和浏览器
</a></li><li class="dropdown-item"><!----> <a href="/blog/css/" class="nav-link">
  css笔记
</a></li><li class="dropdown-item"><!----> <a href="/blog/regexp/" class="nav-link">
  正则
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js框架和库" class="dropdown-title"><span class="title">js框架和库</span> <span class="arrow down"></span></button> <button type="button" aria-label="js框架和库" class="mobile-dropdown-title"><span class="title">js框架和库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vue/" class="nav-link">
  vue专题
</a></li><li class="dropdown-item"><!----> <a href="/blog/react/" class="nav-link">
  react专题
</a></li><li class="dropdown-item"><!----> <a href="/blog/redux/" class="nav-link">
  redux
</a></li><li class="dropdown-item"><!----> <a href="/blog/axios/" class="nav-link">
  axios
</a></li></ul></div></div><div class="nav-item"><a href="/blog/algorithm/" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/blog/interview/" class="nav-link">
  面试题
</a></div> <a href="https://github.com/blueprint1453/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="一面"><a href="#一面" class="header-anchor">#</a> 一面</h1> <ol><li><p>讲项目遇到的问题和难点</p></li> <li><p>cdn有了解过吗，它的架构是怎么样的</p></li> <li><p>跨域问题如何解决</p></li></ol> <ul><li><p>cors 跨域资源共享 后端设置</p></li> <li><p>代理  nginx和服务端接口转发</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// nginx解决跨域配置实例 http://192.168.1.100:8080/api为前缀的请求都会被转发到</span>
  <span class="token comment">// http://ni.hao.sao/api下</span>
  server<span class="token punctuation">{</span>
      listen <span class="token number">8888</span><span class="token punctuation">;</span>
      server_name  <span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span><span class="token punctuation">;</span>

      location <span class="token operator">/</span><span class="token punctuation">{</span>
          proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">192.168</span><span class="token number">.1</span><span class="token number">.100</span><span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      location <span class="token operator">/</span>api<span class="token punctuation">{</span>
          proxy_pass http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ni<span class="token punctuation">.</span>hao<span class="token punctuation">.</span>sao<span class="token operator">/</span>api<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><ul><li><p>postmessage和onmessage 跨文档通信api window和ifranme、Web Worker 和 Service Work 进行通信都是用的 postmessage</p></li> <li><p>jsonp 利用script标签不受同源策略的限制，原理是在客户端定义好回调方法，并添加到请求的
参数中，服务端接受请求后将数据和回调名返回给客户端，客户端拿到响应结果后就可以执行了。</p></li> <li><p>Websocket WebSocket根本不附属于同源策略，而且它本身就有意被设计成可以跨域的一个手段，对于WebSocket的跨域检测工作就交给了服务端</p></li></ul> <h2 id="cors的设置"><a href="#cors的设置" class="header-anchor">#</a> cors的设置</h2> <ol><li><p>Access-Control-Allow-Origin 指示请求的资源能共享给哪些域</p></li> <li><p>Access-Control-Allow-Credentials ： 指示当请求的凭证标记为 true 时，是否响应该请求。</p></li> <li><p>Access-Control-Allow-Headers 用在对预请求的响应中，指示实际的请求中可以使用哪些 HTTP 头。</p></li> <li><p>Access-Control-Allow-Methods： 指定对预请求的响应中，哪些 HTTP 方法允许访问请求的资源。</p></li> <li><p>Access-Control-Expose-Headers 指示哪些 HTTP 头的名称能在响应中列出。</p></li> <li><p>什么是简单请求和复杂请求</p> <ul><li>不会触发 CORS 预检的，就是简单请求。如果一个请求满足是get、post和header之一，并且content-type类型是application/x-www-form-urlencoded、text/plain、multipart/form-data三者之一，请求头的字段类型是 Accept、Accept-Language、Content-Language、Content-Type， 就是一个简单请求，反之就是复杂请求，</li> <li>复杂请求会触发预检 必须在正式发送请求前先发送一个OPTIONS方法的请求已得到服务器的同意，若没有得到服务器的同意，浏览器不会发送正式请求；</li></ul></li> <li><p>不同域名下两个网站进行服务请求法人cookie携带的问题，问蒙了不清楚这个</p></li> <li><p>https的进行的流程
参考文章<a href="https://zhuanlan.zhihu.com/p/56663184" target="_blank" rel="noopener noreferrer">HTTPS原理和通信流程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>https相当于http+ssl/tsl，所以https请求也是会经历tcp三次握手，然后才是https协议的加密协议过程</li> <li>http的缺陷 http是明文传输，容易被窃取。 不会校验数据完整性和可靠性，如果数据在传输中被篡改，接收方是无法验证数据跟发送方的是否一致</li> <li>对称加密 加密和解密的秘钥是同一个秘钥，对称加密的优点是速度快，破解的难度跟秘钥的大小成正比。对称加密双方必须约定好加密规则，对于不同合作者要使用不同的秘钥。</li> <li>分对称加密 加密的秘钥是成对的，私钥自己保存，公钥发给通信的另一方。加密时用其中一个加密，解密时需要使用另外一个秘钥解密。</li> <li>对称加密需要把秘钥发送给对方，中间会有泄露风险。非对称加密因为密钥是成对的，加密和解密用的是不同的秘钥，相对更加安全。非对称加密的公钥可以公布在网络中，任何人拿着公钥是都可以和你进行通信。</li> <li>非对称加密的缺点在于速度慢，所以实际上https使用混合加密方式。混合加密是用非对称加密的方式交换双方的对称加密秘钥，交换对称加密秘钥之后双方再用 对称加密的方式进行通信。</li> <li>数字证书 结局身份伪装问题 数字证书是由第三方颁发 服务端会向第三方申请认证证书，客服端在跟服务器进行通信的时候，会向服务器请求该证书，服务器发送给客户端后，客户端可以去第三方机构验证该证书的合法性。</li> <li>数字签名 解决数据篡改问题 对需要发送的数据使用hash算法生成摘要 主要目的是确认数据的完整性 对摘要进行签名的目的主要是对确认数据发送人的身份，签名技术是使用非对称加密的原理</li></ul></li></ol> <ul><li><p>具体过程如下</p> <ol><li>服务端有一对自己的公钥和私钥 服务端把自己的公钥(key1)发送给第三方机构，申请证书。</li> <li>证书颁发机构自己也有一对公钥私钥。机构利用自己的私钥来加密Key1，生成一个证书签名,
证书签名同样经过机构的私钥加密,证书制作完成后，机构把证书发送给了服务端。</li> <li>当客户端向服务端请求通信的时候，服务端不再直接返回自己的公钥（Key1），而是把自己申请的证书返回给客户端。</li> <li>客户端收到证书以后,会向浏览器和系统内置的第三方证书机构验证证书的真伪</li> <li>客户端对证书验证成功后，就可以放心地再次利用机构公钥，解密出服务端的公钥Key1</li> <li>客户端生成自己的对称加密密钥Key2，并且用服务端公钥Key1加密Key2，发送给服务端。</li> <li>服务端用自己的私钥解开加密，得到对称加密密钥Key2。于是客户端与服务端开始用Key2进行对称加密的通信。</li></ol></li> <li><p>证书颁发以及验证的具体过程</p> <ol><li><p>服务端人员使用RSA算法生成两个密钥，一个用来加密一个用来解密。将负责加密的那个密钥公布出去，所以我们称之为公钥(Public Key)，而用来解密的那个密钥，不能对外公布，只有服务端持有，所以我们称之为私钥(Private Key)。服务端在将Public Key进行分发证书之前需要向CA机构申请给将要分发的公钥进行数字签名。(服务器公钥负责加密，服务器私钥负责解密)</p></li> <li><p>生成数字签名公钥证书：对于CA机构来说，其也有两个密钥，我们暂且称之为CA私钥和CA公钥。CA机构将服务端的Public Key作为输入参数将其转换为一个特有的Hash值。然后使用CA私钥将这个Hash值进行加密处理，并与服务端的Public Key绑定在一起，生成数字签名证书。其实数字签名证书的本质就是服务端的公钥+CA私钥加密的Hash值。(CA私钥负责签名，CA公钥负责验证)</p></li> <li><p>服务器获取到这个已经含有数字签名并带有公钥的证书，将该证书发送给客户端。当客户端收到该公钥数字证书后，会验证其有效性。大部分客户端都会预装CA机构的公钥，也就是CA公钥。客户端使用CA公钥对数字证书上的签名进行验证，这个验证的过程就是使用CA公钥对CA私钥加密的内容进行解密，将解密后的内容与服务端的Public Key所生成的Hash值进行匹配，如果匹配成功，则说明该证书就是相应的服务端发过来的。否则就是非法证书。</p></li></ol></li></ul> <ol start="7"><li>浏览器缓存问题
<ul><li>根据浏览器有没有跟服务器通信， 分为强缓存和协商缓存， 强缓存优先于协商缓存。</li> <li>强缓存控制字段有cache-control，expire，cache-control优先于expire，强缓存命中的话不会跟服务器通信</li> <li>协商缓存控制字段有etag/if-modified-since和last-modified/if-modified-since,前者优先级更高。协商缓存需要跟服务器进行通信</li> <li>chome浏览器的控制台中，我们可以看到缓存具体获取的位置。有from-memory和from-disk两种。from-memory一般是按f5刷新时可以看到，而from-disk一般是页面关闭后又从新打开时可以看到，在火狐浏览器中，并没有具体显示缓存获取位置，只提示来自于缓存</li></ul></li></ol> <h2 id="cache-control具体值的含义"><a href="#cache-control具体值的含义" class="header-anchor">#</a> cache-control具体值的含义</h2> <ul><li>max-age: 诉浏览器端或者中间者，响应资源能够在它被请求之后的多长时间以内被复用</li> <li>s-maxage s-maxage 与上文提到的max-age类似，这里的“s”代表共享，并且，这个指令一般仅用于CDNs或者其他中间者（intermediary caches）。这个指令会覆盖max-age和expires响应头。</li> <li>public 允许被任何中间者（可能是代理服务器、类似于 cdn 网络）缓存,令通常不需要在响应头中用到，因为其他指令已经表明了响应资源是否可以被缓存（例如：max-age）</li> <li>private 指令表示响应资源仅仅只能被获取它的浏览器端缓存</li> <li>no-cache 走协商缓存，向服务器进行通信，检查有没有失效</li> <li>no-store 禁止缓存 处理隐私信息（private information）的时候，这是一个重要的特性</li></ul> <ol start="8"><li><p>问了一些vue的细节问题</p></li> <li><p>react-redux中conenct的实现原理</p></li> <li><p>http1.0、 http1.1 和http2的区别</p></li></ol> <ul><li>HTTP1.0默认是短连接，每次与服务器交互，都需要新开一个连接！</li> <li>HTTP1.1默认是持久化连接！建立一次连接，多次请求均由这个连接完成</li> <li>在HTTP1.0中，发送一次请求时，需要等待服务端响应了才可以继续发送请求。</li> <li>在HTTP1.1中，发送一次请求时，不需要等待服务端响应了就可以发送请求了，但是回送数据给客户端的时候，客户端还是需要按照响应的顺序来一一接收</li> <li>http2.0 实现了多路复用，同时在一个连接上并行执行。某个请求任务耗时严重，不会影响到其它连接的正常执行</li> <li>HTTP1.1新改动 持久连接、请求管道化、增加缓存处理、增加Host字段、支持断点传输等</li> <li>http2.0新增了二进制分帧、多路复用、头部压缩、服务器推送等</li></ul> <ol start="11"><li>http的长连接概念</li></ol> <ul><li>HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接</li> <li>在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用这一条已经建立的连接。Keep-Alive不会永久保持连接，它有一个保持时间</li> <li>TcP属于应用层协议，在传输层使用TCP协议，在网络层使用IP协议。IP协议主要解决网络路由和寻址问题，TCP协议主要解决如何在IP层之上可靠的传递数据包，使在网络上的另一端收到发端发出的所有包，并且顺序与发出顺序一致。TCP有可靠，面向连接的特点。</li></ul> <ol start="12"><li>websocket连接的过程</li></ol> <ul><li><p>websocket实现了一个双向通道，客户端和服务器都可以主动向对方发送消息。在任何一方断开前会一直保持连接状态</p></li> <li><p>WebSocket协议一旦建议后，互相沟通所消耗的请求头是很小的</p></li> <li><p>通过http协议建立通道，然后在此基础上用真正的WebSocket协议进行通信，所以WebSocket协议和http协议是有一定的交叉关系的</p></li> <li><p>websocket连接的请求头中有几个http请求没有的字段</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Connection<span class="token operator">:</span>Upgrade
Upgrade<span class="token operator">:</span>websocket
Sec<span class="token operator">-</span>WebSocket<span class="token operator">-</span>Extensions<span class="token operator">:</span>permessage<span class="token operator">-</span>deflate<span class="token punctuation">;</span> client_max_window_bits
Sec<span class="token operator">-</span>WebSocket<span class="token operator">-</span>Key<span class="token operator">:</span>mg8LvEqrB2vLpyCNnCJV3Q<span class="token operator">==</span>
Sec<span class="token operator">-</span>WebSocket<span class="token operator">-</span>Version<span class="token operator">:</span><span class="token number">13</span>

<span class="token comment">// 1. Connection和Upgrade字段告诉服务器，客户端发起的是WebSocket协议请求</span>
<span class="token comment">// 2. Sec-WebSocket-Extensions表示客户端想要表达的协议级的扩展</span>
<span class="token comment">// 3. Sec-WebSocket-Key是一个Base64编码值，由浏览器随机生成</span>
<span class="token comment">// 4. Sec-WebSocket-Version表明客户端所使用的协议版本</span>
</code></pre></div><ul><li>而得到的响应头中重要的字段</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Status Code<span class="token operator">:</span><span class="token number">101</span> Switching Protocols
Connection<span class="token operator">:</span>Upgrade
Upgrade<span class="token operator">:</span>websocket
Sec<span class="token operator">-</span>WebSocket<span class="token operator">-</span>Accept<span class="token operator">:</span>AYtwtwampsFjE0lu3kFQrmOCzLQ<span class="token operator">=</span>

<span class="token comment">// 101 Switching Protocols 并且http请求完成后响应的状态码为101，表示切换了协议，说明WebSocket协议通过http协议来建立运输层的TCP连接，之后便与http协议无关了。</span>
<span class="token comment">// Connection和Upgrade字段与请求头中的作用相同</span>
<span class="token comment">// Sec-WebSocket-Accept表明服务器接受了客户端的请求</span>

</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/blueprint1453/blog/edit/master/docs/plan/腾讯.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.44f11c97.js" defer></script><script src="/blog/assets/js/2.bea9b8b0.js" defer></script><script src="/blog/assets/js/44.02ad5c3b.js" defer></script>
  </body>
</html>
